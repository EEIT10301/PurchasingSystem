<!DOCTYPE html>
<html>
<head>
<meta charset="BIG5">
<title>已結案請購單</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script type="text/javascript" src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
<input type="hidden" id="appid" disabled="disabled">
<input type="hidden" id="appsta">
<div class='container'>
	<h2 align="center">已結案請購單</h2><br/>
<input class="form-control" id="myInput" type="text" placeholder="Search"><br/>
<table class="table table-striped table-hover">
<thead>
<tr>
<th class='text-center' colspan='6'><h3>請購單</h3></th>
</tr>
</thead>
<tbody id="selectAll"></tbody>
</table>
<script type="text/javascript" charset="utf-8" >
$(document).ready(function(){
	var url = location.href;
	var result = url.split("?");
	var object = result[1].split("&");
	$("#appid").val(object[0].split("=")[1])
	$("#appsta").val(object[1].split("=")[1])
	var txt = ""
	
	$.ajax({
		url:"../Apply/SelectAppdetail.do",
		type:"POST",
		data:{Button:event.target.value,appid:$("#appid").val(),appsta:$("#appsta").val()},
		async:false,
		success:function(data){
		        txt += "<tr>"
			    txt += "<th>請購單號</th>"
			    txt += "<th>請購部門</th>"
			    txt += "<th>請購同仁</th>"
			    txt += "<th>請購項目</th>"
			    txt += "<th>請購總價</th>"
			    txt += "<th>追交期限</th>"
			    txt += "</tr>"
			    var i =0;
				$.each(data.myArrayList,function(index,json){
					//alert(json.map.productListBean.pro_name);
					if(i<1){			
					txt += "<tr>";
					txt += "<td>"+json.map.app_MainBean.map.app_id+"</td>"
					txt += "<td>"+json.map.app_MainBean.map.employeeBean.map.emp_dep+"</td>"
					txt += "<td>"+json.map.app_MainBean.map.employeeBean.map.emp_name+json.map.app_MainBean.map.employeeBean.map.emp_job+"</td>"
					txt += "<td>"+json.map.app_MainBean.map.pro_cate+"</td>"		
					txt += "<td>"+json.map.app_MainBean.map.app_price+"</td>"		
					txt += "<td>"+json.map.app_MainBean.map.app_GetDate+"</td>"		
					txt += "</tr>"
					i++;
					}
				})		
				$("#selectAll").html(txt);	
				//twoajax();
		}
	});
$.ajax({
		url:"../Apply/SelectPodetail.do",
		type:"POST",
		data:{Button:event.target.value,appid:$("#appid").val(),appsta:$("#appsta").val()},
		async:false,
		success:function(data){
		        txt += "<tr>"
			    txt += "<th>採購單號</th>"
			    txt += "<th>採購部門</th>"
			    txt += "<th>採購同仁</th>"
			    txt += "<th>採購總價</th>"
			    txt += "<th>購買廠商</th>"
			    txt += "<th>實際交貨日</th>"
			    txt += "</tr>"
			    var i =0;
				$.each(data.myArrayList,function(index,json){
					//alert(json.map.productListBean.pro_name);
					if(i<1){			
					txt += "<tr>";
					txt += "<td>"+json.map.pO_MainBean.map.po_id+"</td>"
					txt += "<td>"+json.map.pO_MainBean.map.employeeBean.map.emp_dep+"</td>"
					txt += "<td>"+json.map.pO_MainBean.map.employeeBean.map.emp_name+json.map.pO_MainBean.map.employeeBean.map.emp_job+"</td>"		
					txt += "<td>"+json.map.pO_MainBean.map.total_price+"</td>"		
					txt += "<td>"+json.map.pO_MainBean.map.pO_Vendor_InfoBean.map.vendor_name+"</td>"		
					txt += "<td>"+json.map.pO_MainBean.map.shipping_Date+"</td>"		
					txt += "</tr>"
					i++;
					}
				})	
				txt += "<tr>"
			    txt += "<th>請購料號</th>"
			    txt += "<th>請購物料名稱</th>"
			    txt += "<th>請購數量</th>"
			    txt += "<th>實際採購數量</th>"
			    txt += "<th>請購預估價格</th>"
			    txt += "<th>實際採購價格</th>"
			    txt += "</tr>"
			    $.each(data.myArrayList,function(index,json){
						//alert(json.map.productListBean.pro_name);			
						txt += "<tr>";
						txt += "<td>"+json.map.part_No+"</td>"
						txt += "<td>"+json.map.productListBean.map.pro_name+"</td>"
						txt += "<td>"+json.map.total_Qty+"</td>"		
						txt += "<td>"+json.map.quotation+"</td>"		
						txt += "<td>"+json.map.market_Price+"</td>"		
						txt += "<td>"+json.map.total_Price+"</td>"		
						txt += "</tr>"

					})	
				$("#selectAll").html(txt);	
				//twoajax();
		}
	});	
	$.ajax({
		url:"../Apply/SelectAllEndListdetail.do",
		type:"POST",
		data:{Button:event.target.value,appid:$("#appid").val(),appsta:$("#appsta").val()},
		async:false,
		success:function(data){
			    txt += "<tr>"
			    txt += "<th class='text-center' colspan='6' ><h3>簽核流程</h3></th>"
				txt += "</tr>"
				txt += "<tr>"
				txt += "<th>請購單號</th>"
				txt += "<th>請購流程</th>"
				txt += "<th>簽核順序</th>"
				txt += "<th>簽核人</th>"
				txt += "<th>簽核時間</th>"
				txt += "<th>簽核建議</th>"
				txt += "</tr>"
				$.each(data.myArrayList,function(index,json){
					//alert(json.map.productListBean.pro_name);
			
					txt += "<tr>";
					txt += "<td>"+json.map.app_id+"</td>"
					txt += "<td>"+json.map.app_sta+"</td>"
					txt += "<td>"+json.map.sig_rank+"</td>"
					txt += "<td>"+json.map.employeeBean.map.emp_dep+json.map.employeeBean.map.emp_name+json.map.employeeBean.map.emp_job+"</td>"
					txt += "<td>"+json.map.sig_date+"</td>"
					txt += "<td>"+json.map.sig_sug+"</td>"	
					txt += "</tr>"

				})		
				$("#selectAll").html(txt);	
				//twoajax();
		}
	});	

	$.ajax({
		url:"../Apply/SelectAllPOEndListdetail.do",
		type:"POST",
		data:{Button:event.target.value,appid:$("#appid").val(),appsta:$("#appsta").val()},
		async:false,
		success:function(data){
			    
			    txt += "<tr>"
			    txt += "<th>採購單號</th>"
			    txt += "<th>採購流程</th>"
			    txt += "<th>簽核順序</th>"
			    txt += "<th>簽核人</th>"
			    txt += "<th>簽核時間</th>"
			    txt += "<th>簽核建議</th>"
			    txt += "</tr>"
				$.each(data.myArrayList,function(index,json){
					//alert(json.map.productListBean.pro_name);
					txt += "<tr>";
					txt += "<td>"+json.map.po_id+"</td>"
					txt += "<td>"+json.map.po_sta+"</td>"
					txt += "<td>"+json.map.sig_rank+"</td>"
					txt += "<td>"+json.map.employeeBean.map.emp_dep+json.map.employeeBean.map.emp_name+json.map.employeeBean.map.emp_job+"</td>"
					if(json.map.sig_date==null){
						txt += "<td>尚未完成</td>"
						}else{
					   txt += "<td>"+json.map.sig_date+"</td>"	
						}
					if(json.map.sig_sug==null){
					txt += "<td></td>"
					}else{
					txt += "<td>"+json.map.sig_sug+"</td>"			
					}
					txt += "</tr>"
				})
        $("#selectAll").html(txt);	
		} 
	});	

$("#myInput").on("keyup", function() {
		   var value = $(this).val().toLowerCase();
		    $("#selectAll tr").filter(function() {
		      $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
		   });
		});		
	
	
	
});
</script>
<a href='http://localhost:8080/PurchasingSystem/Apply/ApplySearchEndList.html'><button id='' class='btn btn-default' >已結案請購單</button></a>
</div>
</body>
</html>